<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · MolSimToolkitShared.jl</title><meta name="title" content="Home · MolSimToolkitShared.jl"/><meta property="og:title" content="Home · MolSimToolkitShared.jl"/><meta property="twitter:title" content="Home · MolSimToolkitShared.jl"/><meta name="description" content="Documentation for MolSimToolkitShared.jl."/><meta property="og:description" content="Documentation for MolSimToolkitShared.jl."/><meta property="twitter:description" content="Documentation for MolSimToolkitShared.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.svg" alt="MolSimToolkitShared.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>MolSimToolkitShared.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/MolSimToolkitShared.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/MolSimToolkitShared.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MolSimToolkitShared.jl"><a class="docs-heading-anchor" href="#MolSimToolkitShared.jl">MolSimToolkitShared.jl</a><a id="MolSimToolkitShared.jl-1"></a><a class="docs-heading-anchor-permalink" href="#MolSimToolkitShared.jl" title="Permalink"></a></h1><p><a href="https://github.com/m3g/MolSimToolkitShared.jl">MolSimToolkitShared.jl</a> is a  low-level package defining a series of functions and function names that  are shared among other packages, such as <a href="https://github.com/m3g/MolSimToolkit.jl">MolSimToolkit.jl</a>,  <a href="https://github.com/m3g/PDBTools.jl">PDBTools.jl</a>, and <a href="https://github.com/m3g/ComplexMixtures.jl">ComplexMixtures.jl</a>.</p><p>Normally this package won&#39;t be used by the end-user, but as a dependency of other packages.</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><h3 id="Function-name-placeholders"><a class="docs-heading-anchor" href="#Function-name-placeholders">Function name placeholders</a><a id="Function-name-placeholders-1"></a><a class="docs-heading-anchor-permalink" href="#Function-name-placeholders" title="Permalink"></a></h3><p>These function names are considered public:</p><pre><code class="nohighlight hljs">distance, distances
coordination_number, bulk_coordination
center_of_mass
wrap, wrap_to_first
align, align!, rmsd
dihedral, dihedrals</code></pre><h3 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkitShared.align" href="#MolSimToolkitShared.align"><code>MolSimToolkitShared.align</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">align(x, y; mass = nothing)
align!(x, y; mass = nothing)</code></pre><p>Aligns two structures (sets of points in 3D space). Solves the &quot;Procrustes&quot; problem, which is to find the best translation, and rotation, that aligns the two structures, minimizing the RMSD between them.</p><p>Structures are expected to be of the same size, and the  correspondence is assumed from the vector indices. </p><p><code>align</code> returns a new vector containing the coordinates of x aligned to y.  <code>align!</code> modifies the input vector <code>x</code> in place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkitShared.jl/blob/5231fea075d5f3a0a99a5f49ceb1a2cedb483db2/src/structural_alignment.jl#L72-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkitShared.align!" href="#MolSimToolkitShared.align!"><code>MolSimToolkitShared.align!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">align(x, y; mass = nothing)
align!(x, y; mass = nothing)</code></pre><p>Aligns two structures (sets of points in 3D space). Solves the &quot;Procrustes&quot; problem, which is to find the best translation, and rotation, that aligns the two structures, minimizing the RMSD between them.</p><p>Structures are expected to be of the same size, and the  correspondence is assumed from the vector indices. </p><p><code>align</code> returns a new vector containing the coordinates of x aligned to y.  <code>align!</code> modifies the input vector <code>x</code> in place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkitShared.jl/blob/5231fea075d5f3a0a99a5f49ceb1a2cedb483db2/src/structural_alignment.jl#L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkitShared.center_of_mass-Tuple{AbstractVector{&lt;:AbstractVector}}" href="#MolSimToolkitShared.center_of_mass-Tuple{AbstractVector{&lt;:AbstractVector}}"><code>MolSimToolkitShared.center_of_mass</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">center_of_mass(x::AbstractVector{&lt;:AbstractVector}[, mass::AbstractVector=nothing])</code></pre><p>Calculate the center of mass of a set of points.</p><p><strong>Arguments</strong></p><ul><li><code>x::AbstractVector{&lt;:AbstractVector}</code>: A vector of coordinates.</li><li><code>mass::AbstractVector</code>: A vector of masses. If not provided, all masses are assumed to be equal.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; import MolSimToolkitShared: center_of_mass

julia&gt; x = [ [1.0, 2.0, 3.0], [4.0, 5.0, 6.0], [7.0, 8.0, 9.0] ];

julia&gt; center_of_mass(x)
3-element Vector{Float64}:
 4.0
 5.0
 6.0

julia&gt; center_of_mass(x, [1.0, 2.0, 3.0]) # providing masses
3-element Vector{Float64}:
 5.0
 6.0
 7.0
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkitShared.jl/blob/5231fea075d5f3a0a99a5f49ceb1a2cedb483db2/src/structural_alignment.jl#L1-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkitShared.dihedral-NTuple{4, AbstractVector}" href="#MolSimToolkitShared.dihedral-NTuple{4, AbstractVector}"><code>MolSimToolkitShared.dihedral</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dihedral(v1, v2, v3, v4; degrees=true)
dihedral(v::AbstractVector; degrees=true)</code></pre><p>Computes the dihedral angle between the planes formed by the vectors <code>v1-v2</code> and <code>v2-v3</code>, and <code>v2-v3</code> and <code>v3-v4</code>. The input vectors must have 3 elements. The function returns the dihedral angle in radians or degrees.</p><p>If the input is a vector with 4 vectors, the function computes the dihedral angle between the planes  formed by the vectors <code>v[1]-v[2]</code> and <code>v[2]-v[3]</code>, and <code>v[2]-v[3]</code> and <code>v[3]-v[4]</code>.</p><p>The optional argument <code>degrees</code> specifies whether the output is in degrees (default) or radians.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkitShared.jl/blob/5231fea075d5f3a0a99a5f49ceb1a2cedb483db2/src/dihedral.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkitShared.dihedrals-Tuple{AbstractVector{&lt;:AbstractVector}}" href="#MolSimToolkitShared.dihedrals-Tuple{AbstractVector{&lt;:AbstractVector}}"><code>MolSimToolkitShared.dihedrals</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dihedrals(v::AbstractVector{&lt;:AbstractVector}; degrees=true)</code></pre><p>Computes the dihedral angles for many sets of 4 vectors. The input is a vector of vectors, where each element is a vector with 4 vectors. The function returns a vector with the dihedral angles in radians or degrees.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkitShared: dihedrals

julia&gt; v1 = [[-8.483, -14.912, -6.726], [-5.113, -13.737, -5.466], [-3.903, -11.262, -8.062], [-1.162, -9.64, -6.015]];

julia&gt; v2 = [[-9.229, -14.861, -5.481], [-8.483, -14.912, -6.726], [-7.227, -14.047, -6.599], [-7.083, -13.048, -7.303]];

julia&gt; dihedrals([v1,v2])
2-element Vector{Float64}:
  164.43481280739516
 -115.82544005374316</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkitShared.jl/blob/5231fea075d5f3a0a99a5f49ceb1a2cedb483db2/src/dihedral.jl#L103-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkitShared.rmsd-Tuple{AbstractVector{&lt;:AbstractVector}, AbstractVector{&lt;:AbstractVector}}" href="#MolSimToolkitShared.rmsd-Tuple{AbstractVector{&lt;:AbstractVector}, AbstractVector{&lt;:AbstractVector}}"><code>MolSimToolkitShared.rmsd</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rmsd(x::AbstractVector,y::AbstractVector)</code></pre><p>Calculate the root mean square deviation between two vectors of coordinates.</p><p><strong>Arguments</strong></p><ul><li><code>x::AbstractVector</code>: A vector of coordinates.</li><li><code>y::AbstractVector</code>: A vector of coordinates.</li></ul><p><strong>Returns</strong></p><ul><li><code>rmsd::Real</code>: The root mean square deviation between the two vectors.</li></ul><pre><code class="language-julia-repl hljs">julia&gt; import MolSimToolkitShared: rmsd

julia&gt; x = [ [1.0, 2.0, 3.0], [4.0, 5.0, 6.0], [7.0, 8.0, 9.0] ];

julia&gt; y = [ [2.0, 3.0, 4.0], [4.0, 5.0, 6.0], [7.0, 8.0, 9.0] ];

julia&gt; rmsd(x, y)
1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkitShared.jl/blob/5231fea075d5f3a0a99a5f49ceb1a2cedb483db2/src/structural_alignment.jl#L38-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkitShared.wrap" href="#MolSimToolkitShared.wrap"><code>MolSimToolkitShared.wrap</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wrap(x, xref, unit_cell_matrix::SMatrix{N,N,T}) where {N,T}
wrap(x, xref, sides::AbstractVector)</code></pre><p>Wraps the coordinates of point <code>x</code> such that it is the minimum image relative to <code>xref</code>. The unit cell  may be given a a static matrix of size <code>(N,N)</code> or as a vector of length <code>N</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkitShared.jl/blob/5231fea075d5f3a0a99a5f49ceb1a2cedb483db2/src/wrap.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MolSimToolkitShared.wrap_to_first" href="#MolSimToolkitShared.wrap_to_first"><code>MolSimToolkitShared.wrap_to_first</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wrap_to_first(x, unit_cell_matrix)</code></pre><p>Wraps the coordinates of point <code>x</code> such that the returning coordinates are in the first unit cell with all-positive coordinates. The unit cell  has to be a matrix of size <code>(N,N)</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MolSimToolkitShared: wrap_to_first

julia&gt; uc = [10.0 0.0 0.0; 0.0 10.0 0.0; 0.0 0.0 10.0]
3×3 Matrix{Float64}:
 10.0   0.0   0.0
  0.0  10.0   0.0
  0.0   0.0  10.0

julia&gt; wrap_to_first([15.0, 13.0, 2.0], uc)
3-element Vector{Float64}:
 5.0
 3.0000000000000004
 2.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/MolSimToolkitShared.jl/blob/5231fea075d5f3a0a99a5f49ceb1a2cedb483db2/src/wrap.jl#L31-L56">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 12 September 2025 19:49">Friday 12 September 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
